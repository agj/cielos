(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();class u{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}}class J{static fromArray(t,n){let r=n||new v;for(let s=t.length-1;s>=0;--s)r=new ye(t[s],r);return r}[Symbol.iterator](){return new ut(this)}toArray(){return[...this]}atLeastLength(t){let n=this;for(;t-- >0&&n;)n=n.tail;return n!==void 0}hasLength(t){let n=this;for(;t-- >0&&n;)n=n.tail;return t===-1&&n instanceof v}countLength(){let t=this,n=0;for(;t;)t=t.tail,n++;return n-1}}function O(e,t){return new ye(e,t)}function $(e,t){return J.fromArray(e,t)}class ut{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof v)return{done:!0};{let{head:t,tail:n}=this.#e;return this.#e=n,{value:t,done:!1}}}}class v extends J{}class ye extends J{constructor(t,n){super(),this.head=t,this.tail=n}}class D extends u{static isResult(t){return t instanceof D}}class p extends D{constructor(t){super(),this[0]=t}isOk(){return!0}}const ct=e=>e instanceof p,ot=e=>e[0];class K extends D{constructor(t){super(),this[0]=t}isOk(){return!1}}function b(e,t){return t===0?0:e/t}function m(e,t,n,r,s,i,a){let l=new globalThis.Error(i);l.gleam_error=e,l.file=t,l.module=n,l.line=r,l.function=s,l.fn=s;for(let c in a)l[c]=a[c];return l}class be extends u{}class Pe extends u{}class ft extends u{}class h extends u{constructor(t){super(),this[0]=t}}class _t extends u{}function Te(e,t){for(;;){let n=e,r=t;if(n instanceof v)return r;{let s=n.head;e=n.tail,t=O(s,r)}}}function ke(e){return Te(e,$([]))}function pt(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof v)return ke(i);{let a=r.head;e=r.tail,t=s,n=O(s(a),i)}}}function H(e,t){return pt(e,t,$([]))}function dt(e,t){for(;;){let n=e,r=t;if(n instanceof v)return ke(r);{let s=n.head;e=n.tail,t=Te(s,r)}}}function ht(e){return dt(e,$([]))}function wt(e,t){return ht(H(e,t))}function gt(e,t,n){for(;;){let r=e,s=t,i=n,a=Lt(r,s);if(a instanceof be)e=r,t=s-1,n=O(s,i);else{if(a instanceof Pe)return O(s,i);e=r,t=s+1,n=O(s,i)}}}function Ee(e,t){return gt(e,t,$([]))}function xt(e){return e.toString()}function mt(e){return Math.ceil(e)}function vt(e){return Math.floor(e)}function ue(e){return Math.round(e)}function $t(e,t){return Math.pow(e,t)}function R(e){const t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{const n=t.indexOf("e");return n>=0?t.slice(0,n)+".0"+t.slice(n):t+".0"}}function yt(e,t){return e<t?e:t}function bt(e,t){return e>t?e:t}function Ae(e,t,n){let s=yt(e,n);return bt(s,t)}function ce(e){return e>=0?e:0-e}function Pt(e,t){let n=mt(t)-t>0;return e<0&&n||e===0&&t<0?new K(void 0):new p($t(e,t))}function Tt(e){return Pt(e,.5)}function Q(e){return-1*e}function oe(e){return e>=0?ue(e):0-ue(Q(e))}function kt(e,t){for(;;){let n=e,r=t;if(n instanceof v)return r;{let s=n.head;e=n.tail,t=s+r}}}function Et(e){return kt(e,0)}function fe(e,t){if(t===0)return new K(void 0);{let n=t;return new p(b(e,n))}}function At(e,t){return e+t}function _e(e,t){return e*t}function St(e,t){return e-t}function Lt(e,t){return e===t?new Pe:e<t?new be:new ft}function Mt(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof v)return i;{let a=r.head;e=r.tail,t=s,n=i+s+a}}}function Ot(e,t){if(e instanceof v)return"";{let n=e.head,r=e.tail;return Mt(r,t,n)}}function F(e,t){if(e instanceof p){let n=e[0];return t(n)}else return e}const pe="src/gleam_community/colour.gleam";class It extends u{constructor(t,n,r,s){super(),this.r=t,this.g=n,this.b=r,this.a=s}}class Kt extends u{constructor(t,n,r,s){super(),this.h=t,this.s=n,this.l=r,this.a=s}}function q(e){return e>1||e<0?new K(void 0):new p(e)}function z(e,t,n){let r;e<0?r=e+1:e>1?r=e-1:r=e;let s=r,i=s*6,a=s*2,l=s*3;return i<1?t+(n-t)*s*6:a<1?n:l<2?t+(n-t)*(2/3-s)*6:t}function jt(e,t,n,r){let s;n<=.5?s=n*(t+1):s=n+t-n*t;let a=s,l=n*2-a,c=z(e+1/3,l,a),o=z(e,l,a),f=z(e-1/3,l,a);return[c,o,f,r]}function Se(e,t,n,r){return F(q(e),s=>F(q(t),i=>F(q(n),a=>F(q(r),l=>new p(new Kt(s,i,a,l))))))}function Le(e,t,n){return Se(e,t,n,1)}function Nt(e){if(e instanceof It){let t=e.r,n=e.g,r=e.b,s=e.a;return[t,n,r,s]}else{let t=e.h,n=e.s,r=e.l,s=e.a;return jt(t,n,r,s)}}function de(e){let t=Nt(e),n,r,s,i;n=t[0],r=t[1],s=t[2],i=t[3];let a=c=>{let o,d=_e(c,1e4),g=oe(d),x=g;o=fe(x,100);let _=o,w;if(_ instanceof p)w=_[0];else throw m("let_assert",pe,"gleam_community/colour",706,"to_css_rgba_string","Pattern match failed, no pattern matched the value.",{value:_,start:20510,end:20646,pattern_start:20521,pattern_end:20526});return w},l=c=>{let o,d=_e(c,1e3),g=oe(d),x=g;o=fe(x,1e3);let _=o,w;if(_ instanceof p)w=_[0];else throw m("let_assert",pe,"gleam_community/colour",718,"to_css_rgba_string","Pattern match failed, no pattern matched the value.",{value:_,start:20768,end:20903,pattern_start:20779,pattern_end:20784});return w};return Ot($(["rgba(",R(a(n))+"%,",R(a(r))+"%,",R(a(s))+"%,",R(l(i)),")"]),"")}function Rt(e){return Math.sin(e)}function Me(){return Math.PI}function Ft(e,t){return Math.atan2(e,t)}function qt(e){return Math.cos(e)}function Ct(e,t){return Ft(e,t)}function Bt(e){return qt(e)}function Oe(e){return Rt(e)}function Ie(e,t){let n=e*Bt(t),r=e*Oe(t);return[n,r]}function Xt(e){return e*Me()/180}function Ke(){return Me()}function C(){return 2*Ke()}function Dt(){return Math.PI}class je extends u{}class Ne extends u{constructor(t,n){super(),this[0]=t,this.closed=n}}class Re extends u{constructor(t,n,r){super(),this.radius=t,this.start=n,this.end=r}}class Ht extends u{constructor(t,n){super(),this.text=t,this.style=n}}class Yt extends u{constructor(t,n,r){super(),this[0]=t,this.width_px=n,this.height_px=r}}class Fe extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class qe extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class Ut extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class Ce extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class Be extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class zt extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class Xe extends u{constructor(t){super(),this[0]=t}}class Vt extends u{}class De extends u{}class he extends u{constructor(t){super(),this[0]=t}}function Wt(){return new je}function Gt(e){return new Ne(e,!0)}function He(e,t){return Gt($([[0,0],[e,0],[e,t],[0,t]]))}function ee(e,t,n){return new Ce(e,[t,n])}function Ye(e,t){return ee(e,0,t)}function Zt(e,t){return new Be(e,[t,t])}function te(e,t){return new Fe(e,t)}function ne(e){return new qe(e,new De)}function X(e){return new Xe(e)}function Jt(e){return new Re(e,new he(0),new he(2*Dt()))}class Ue extends u{constructor(t){super(),this[0]=t}}class ze extends u{constructor(t){super(),this[0]=t}}class Qt extends u{constructor(t){super(),this[0]=t}}class Ve extends u{constructor(t,n){super(),this[0]=t,this[1]=n}}class We extends u{constructor(t){super(),this[0]=t}}class Ge extends u{constructor(t){super(),this[0]=t}}class Ze extends u{}class Je extends u{}class Qe extends u{}class et extends u{}class en extends u{}class tn extends u{}class nn extends u{}class rn extends u{}class sn extends u{}class an extends u{}class ln extends u{}class un extends u{}class cn extends u{}class on extends u{}class fn extends u{}class G extends u{}class _n extends u{}class pn extends u{}function dn(e){return document.querySelector(e).getContext("2d")}function tt(e){window.requestAnimationFrame(t=>{e(t)})}function V(e,t){window.addEventListener(e,t)}function hn(e){return e.keyCode}function A(e,t){typeof window.PAINT_STATE>"u"&&(window.PAINT_STATE={}),window.PAINT_STATE[t]=e}function S(e){return window.PAINT_STATE?e in window.PAINT_STATE?new p(window.PAINT_STATE[e]):new K(void 0):new K(void 0)}function wn(e){return e.canvas.clientWidth}function gn(e){return e.canvas.clientHeight}function xn(e,t){const n=e.canvas.getBoundingClientRect(),r=e.canvas.width/n.width,s=e.canvas.height/n.height;return[(t.clientX-n.left)*r,(t.clientY-n.top)*s]}function mn(e,t,n,r){let s=ct(t)?ot(t).buttons:0,i=e.buttons;return r?s=~s:i=~i,!!(s&i&1<<n)}function vn(e){e.reset()}function $n(e,t,n,r,s,i){e.beginPath(),e.arc(0,0,t,n,r),s&&e.fill(),i&&e.stroke()}function yn(e,t,n,r,s){e.beginPath(),e.moveTo(0,0);let i=!1;for(const a of t){let l=a[0],c=a[1];i?e.lineTo(l,c):(e.moveTo(l,c),i=!0)}n&&e.closePath(),r&&n&&e.fill(),s&&e.stroke()}function bn(e,t,n){e.font=n,e.fillText(t,0,0)}function T(e){e.save()}function k(e){e.restore()}function Pn(e,t){e.fillStyle=t}function Tn(e,t){e.strokeStyle=t}function kn(e,t){e.lineWidth=t}function En(e,t,n){e.translate(t,n)}function An(e,t,n){e.scale(t,n)}function Sn(e,t){e.rotate(t)}function Ln(e,t,n,r){e.drawImage(t,0,0,n,r)}function Mn(e,t){e.imageSmoothingEnabled=t}const I="src/paint/canvas.gleam";class On extends u{constructor(t,n){super(),this.width=t,this.height=n}}class B extends u{constructor(t,n){super(),this.fill=t,this.stroke=n}}function y(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof je)return;if(r instanceof Ne){let a=r[0],l=r.closed;return yn(s,a,l,i.fill,i.stroke)}else if(r instanceof Re){let a=r.radius,l=r.start,c=r.end,o;o=l[0];let f;return f=c[0],$n(s,a,o,f,i.fill,i.stroke)}else if(r instanceof Ht){let a=r.text,l=r.style,c,o;return c=l.size_px,o=l.font_family,T(s),bn(s,a,xt(c)+"px "+o),k(s)}else if(r instanceof Yt){let a=r.width_px,l=r.height_px,c=r[0].id,o=S(c),f;if(o instanceof p)f=o[0];else throw m("let_assert",I,"paint/canvas",231,"display_on_rendering_context","Pattern match failed, no pattern matched the value.",{value:o,start:6608,end:6657,pattern_start:6619,pattern_end:6628});return Ln(s,f,a,l)}else if(r instanceof Fe){let a=r[0],l=r[1];return T(s),Pn(s,de(l)),y(a,s,new B(!0,i.stroke)),k(s)}else if(r instanceof qe){let a=r[0],l=r[1];if(l instanceof De)e=a,t=s,n=new B(i.fill,!1);else{let c=l[0],o=l[1];return T(s),Tn(s,de(c)),kn(s,o),y(a,s,new B(i.fill,!0)),k(s)}}else if(r instanceof Ut){let a=r[0],l=r[1];return T(s),Mn(s,l instanceof Vt),y(a,s,i),k(s)}else if(r instanceof Ce){let a=r[0],l=r[1],c,o;return c=l[0],o=l[1],T(s),En(s,c,o),y(a,s,i),k(s)}else if(r instanceof Be){let a=r[0],l=r[1],c,o;return c=l[0],o=l[1],T(s),An(s,c,o),y(a,s,i),k(s)}else if(r instanceof zt){let a=r[0],l=r[1],c;return c=l[0],T(s),Sn(s,c),y(a,s,i),k(s)}else{let a=r[0];if(a instanceof v)return;{let l=a.head,c=a.tail;y(l,s,i),e=new Xe(c),t=s,n=i}}}}function In(e){return e===32?new h(new en):e===37?new h(new Ze):e===38?new h(new Qe):e===39?new h(new Je):e===40?new h(new et):e===87?new h(new tn):e===65?new h(new nn):e===83?new h(new rn):e===68?new h(new sn):e===90?new h(new an):e===88?new h(new ln):e===67?new h(new un):e===18?new h(new cn):e===27?new h(new on):e===8?new h(new fn):new _t}const Kn=new B(!1,!0);function nt(e,t,n,r){return s=>{let i=S(r),a;if(i instanceof p)a=i[0];else throw m("let_assert",I,"paint/canvas",399,"get_tick_func","Pattern match failed, no pattern matched the value.",{value:i,start:11581,end:11644,pattern_start:11592,pattern_end:11609});let l=n(a,new Ue(s));A(l,r);let c=t(l);return vn(e),y(c,e,Kn),tt(nt(e,t,n,r))}}function jn(e,t,n,r){let s=dn(r),i=e(new On(wn(s),gn(s)));A(i,r);let a=(c,o)=>V(c,f=>{let d=In(hn(f));if(d instanceof h){let g=d[0],x=S(r),_;if(x instanceof p)_=x[0];else throw m("let_assert",I,"paint/canvas",292,"interact","Pattern match failed, no pattern matched the value.",{value:x,start:8332,end:8391,pattern_start:8343,pattern_end:8356});let w=t(_,o(g));return A(w,r)}else return});a("keydown",c=>new ze(c)),a("keyup",c=>new Qt(c)),V("mousemove",c=>{let o=xn(s,c),f,d;f=o[0],d=o[1];let g=S(r),x;if(g instanceof p)x=g[0];else throw m("let_assert",I,"paint/canvas",309,"interact","Pattern match failed, no pattern matched the value.",{value:g,start:8863,end:8922,pattern_start:8874,pattern_end:8887});let _=t(x,new Ve(f,d));A(_,r)});let l=(c,o,f)=>V(c,d=>{let g="PAINT_PREVIOUS_MOUSE_INPUT_FOR_"+r,x=S(g);A(d,g);let _=L=>mn(d,x,L,f),w=L=>{let M=S(r),le;if(M instanceof p)le=M[0];else throw m("let_assert",I,"paint/canvas",338,"interact","Pattern match failed, no pattern matched the value.",{value:M,start:9856,end:9915,pattern_start:9867,pattern_end:9880});let lt=t(le,o(L));return A(lt,r)};_(0)&&w(new G),_(1)&&w(new _n),_(2)&&w(new pn)});return l("mousedown",c=>new We(c),!0),l("mouseup",c=>new Ge(c),!1),tt(nt(s,n,t,r))}class P extends u{constructor(t,n){super(),this.x=t,this.y=n}}function Nn(e){return $([e.x,e.y])}function rt(e,t,n){return new P(n(e.x,t.x),n(e.y,t.y))}const Rn="src/vec/vec2f.gleam";function Fn(e,t){return rt(e,t,At)}function qn(e){let n=Nn(e),r=H(n,s=>s*s);return Et(r)}function Cn(e,t){let r=rt(e,t,St);return qn(r)}function Bn(e,t){let n,r=Cn(e,t);n=Tt(r);let s=n,i;if(s instanceof p)i=s[0];else throw m("let_assert",Rn,"vec/vec2f",385,"distance","Pattern match failed, no pattern matched the value.",{value:s,start:8217,end:8288,pattern_start:8228,pattern_end:8240});return i}const re="src/app.gleam";class E extends u{constructor(t,n,r,s,i,a,l){super(),this.avatar=t,this.camera=n,this.speed=r,this.objects=s,this.mouse_pos=i,this.drag=a,this.current_time=l}}class Y extends u{constructor(t,n){super(),this.pos=t,this.dir=n}}let we=class extends u{constructor(t,n,r){super(),this.pos=t,this.height=n,this.kind=r}};class st extends u{}class Xn extends u{}class it extends u{constructor(t,n){super(),this.lagging_dir=t,this.start_move_time=n}}class se extends u{}class Dn extends u{constructor(t){super(),this.start_pos=t}}function Hn(e,t,n){let r=t*n,s=Ie(r,e.dir),i,a;return i=s[0],a=s[1],new Y(Fn(e.pos,new P(i,a)),e.dir)}function W(e,t,n){return(t-e)*n+e}function ge(e,t,n,r,s,i,a,l,c){let o=c,f=vt(b(l,o)),d=Ee(0,c),g=H(d,x=>{let _=x,w=b(_,o),N=Le(W(e,r,w),W(t,s,w),W(n,i,w)),U;if(N instanceof p)U=N[0];else throw m("let_assert",re,"app",263,"view_gradient","Pattern match failed, no pattern matched the value.",{value:N,start:5684,end:5911,pattern_start:5695,pattern_end:5707});let ae=He(a,f),L=Ye(ae,f*_),M=te(L,U);return ne(M)});return X(g)}function Yn(){let e=Le(.12,1,.7),t;if(e instanceof p)t=e[0];else throw m("let_assert",re,"app",283,"view_star","Pattern match failed, no pattern matched the value.",{value:e,start:6203,end:6262,pattern_start:6214,pattern_end:6228});let n=Jt(300),r=te(n,t);return ne(r)}function Un(){let e=Se(.75,.5,.4,.05),t;if(e instanceof p)t=e[0];else throw m("let_assert",re,"app",291,"view_shadow","Pattern match failed, no pattern matched the value.",{value:e,start:6362,end:6430,pattern_start:6373,pattern_end:6389});let n=He(200,5e3),r=te(n,t);return ne(r)}function zn(e){return e instanceof st?Yn():Un()}function at(e,t,n){let r=100,s=e.start_move_time,i=s+r;if(n>=i)return t;{let l=b(n-s,r);return t*l+e.lagging_dir*(1-l)}}function Vn(e){return b(1,b(e,.2)+1)}function Wn(e,t){let n=Ie(e,t),r,s;return r=n[0],s=n[1],new P(r,s)}function Gn(e){let t=.8*C(),n,r=Ee(0,200);n=wt(r,i=>{let a=i,l=Wn((a+1)*2+10,a/20*C()),c=Oe(a/5*C());return $([new we(l,c,new st),new we(l,-10,new Xn)])});let s=n;return new E(new Y(new P(0,0),t),new it(t,0),.01,s,new P(0,0),new se,0)}function xe(e,t,n,r){return Ct(r-t,n-e)}function Zn(e){for(;;){let t=e,n=C(),r=Ke(),s=Q(r),i=t;if(i>r)e=i-n;else{let a=t;if(a<=s)e=a+n;else return t}}}const me=300,ve=300,j=new P(150,150);function Jn(){let e=$([ge(.85,.6,.9,.7,.4,.98,me,ve/2,50),(()=>{let t=ge(.6,.4,.95,.6,.7,.8,me,ve/2,50);return Ye(t,j.y)})()]);return X(e)}function Qn(e,t){let n=Xt(45),r=xe(t.pos.x,t.pos.y,e.pos.x,e.pos.y),s=Zn(r-t.dir);if(ce(s)>n)return Wt();{let a=ce(Bn(t.pos,e.pos)),l=xe(0,0,a,e.height),c=Vn(a),o=new P(b(s*j.x,n),Q(b(l*j.x,n))),f=zn(e.kind),d=Zt(f,c);return ee(d,o.x,o.y)}}function er(e){let t,n=e.avatar;t=new Y(n.pos,at(e.camera,e.avatar.dir,e.current_time));let r=t,s,i=X((()=>{let l=e.objects;return H(l,c=>Qn(c,r))})());s=ee(i,j.x,j.y);let a=s;return X($([Jn(),a]))}const tr=.005,nr=.4;function $e(e,t){return new E(e.avatar,e.camera,Ae(e.speed+t*(e.speed*.05),tr,nr),e.objects,e.mouse_pos,e.drag,e.current_time)}const rr=.09;function sr(e,t){return new Y(e.pos,e.dir+rr*t)}function Z(e,t){return new E(sr(e.avatar,t),new it(at(e.camera,e.avatar.dir,e.current_time),e.current_time),e.speed,e.objects,e.mouse_pos,e.drag,e.current_time)}function ir(e,t){let n=e.drag;if(n instanceof se)return e;{let r=n.start_pos,s,i=(e.mouse_pos.x-r.x)*.001;s=Ae(i,-.02,.02);let l=s*t;return Z(e,l)}}function ar(e,t){if(t instanceof Ue){let n=t[0],r=n-e.current_time,s=new E(Hn(e.avatar,e.speed,r),e.camera,e.speed,e.objects,e.mouse_pos,e.drag,n);return ir(s,r)}else if(t instanceof ze){let n=t[0];return n instanceof Ze?Z(e,-1):n instanceof Je?Z(e,1):n instanceof Qe?$e(e,1):n instanceof et?$e(e,-1):e}else if(t instanceof Ve){let n=t[0],r=t[1];return new E(e.avatar,e.camera,e.speed,e.objects,new P(n,r),e.drag,e.current_time)}else return t instanceof We?t[0]instanceof G?new E(e.avatar,e.camera,e.speed,e.objects,e.mouse_pos,new Dn(e.mouse_pos),e.current_time):e:t instanceof Ge&&t[0]instanceof G?new E(e.avatar,e.camera,e.speed,e.objects,e.mouse_pos,new se,e.current_time):e}function lr(){return jn(Gn,ar,er,"#app")}lr();document.addEventListener("touchmove",e=>{e.preventDefault()},{passive:!1});const ie=(e,t)=>n=>{const r=n.touches?.item(0),s=r?{screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY}:{};e==="mousedown"&&window.dispatchEvent(new MouseEvent("mousemove",{...s})),window.dispatchEvent(new MouseEvent(e,{buttons:t,...s}))};window.addEventListener("touchstart",ie("mousedown",1));window.addEventListener("touchend",ie("mouseup",0));window.addEventListener("touchmove",ie("mousemove",void 0));

(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();class l{withFields(t){let n=Object.keys(this).map(r=>r in t?t[r]:this[r]);return new this.constructor(...n)}}class V{static fromArray(t,n){let r=n||new v;for(let s=t.length-1;s>=0;--s)r=new fe(t[s],r);return r}[Symbol.iterator](){return new We(this)}toArray(){return[...this]}atLeastLength(t){let n=this;for(;t-- >0&&n;)n=n.tail;return n!==void 0}hasLength(t){let n=this;for(;t-- >0&&n;)n=n.tail;return t===-1&&n instanceof v}countLength(){let t=this,n=0;for(;t;)t=t.tail,n++;return n-1}}function L(e,t){return new fe(e,t)}function E(e,t){return V.fromArray(e,t)}class We{#e;constructor(t){this.#e=t}next(){if(this.#e instanceof v)return{done:!0};{let{head:t,tail:n}=this.#e;return this.#e=n,{value:t,done:!1}}}}class v extends V{}class fe extends V{constructor(t,n){super(),this.head=t,this.tail=n}}class C extends l{static isResult(t){return t instanceof C}}class p extends C{constructor(t){super(),this[0]=t}isOk(){return!0}}const Ge=e=>e instanceof p,Ze=e=>e[0];class I extends C{constructor(t){super(),this[0]=t}isOk(){return!1}}function S(e,t){return t===0?0:e/t}function m(e,t,n,r,s,i,a){let u=new globalThis.Error(i);u.gleam_error=e,u.file=t,u.module=n,u.line=r,u.function=s,u.fn=s;for(let c in a)u[c]=a[c];return u}class _e extends l{}class de extends l{}class Je extends l{}class w extends l{constructor(t){super(),this[0]=t}}class Qe extends l{}function et(e,t){for(;;){let n=e,r=t;if(n instanceof v)return r;{let s=n.head;e=n.tail,t=L(s,r)}}}function tt(e){return et(e,E([]))}function nt(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof v)return tt(i);{let a=r.head;e=r.tail,t=s,n=L(s(a),i)}}}function W(e,t){return nt(e,t,E([]))}function rt(e,t,n){for(;;){let r=e,s=t,i=n,a=gt(r,s);if(a instanceof _e)e=r,t=s-1,n=L(s,i);else{if(a instanceof de)return L(s,i);e=r,t=s+1,n=L(s,i)}}}function st(e,t){return rt(e,t,E([]))}function it(e){return e.toString()}function at(e){return Math.ceil(e)}function ee(e){return Math.round(e)}function ut(e,t){return Math.pow(e,t)}function O(e){const t=e.toString().replace("+","");if(t.indexOf(".")>=0)return t;{const n=t.indexOf("e");return n>=0?t.slice(0,n)+".0"+t.slice(n):t+".0"}}function lt(e,t){return e<t?e:t}function ct(e,t){return e>t?e:t}function ot(e,t,n){let s=lt(e,n);return ct(s,t)}function te(e){return e>=0?e:0-e}function ft(e,t){let n=at(t)-t>0;return e<0&&n||e===0&&t<0?new I(void 0):new p(ut(e,t))}function _t(e){return ft(e,.5)}function pe(e){return-1*e}function ne(e){return e>=0?ee(e):0-ee(pe(e))}function dt(e,t){for(;;){let n=e,r=t;if(n instanceof v)return r;{let s=n.head;e=n.tail,t=s+r}}}function pt(e){return dt(e,0)}function re(e,t){if(t===0)return new I(void 0);{let n=t;return new p(S(e,n))}}function ht(e,t){return e+t}function se(e,t){return e*t}function wt(e,t){return e-t}function gt(e,t){return e===t?new de:e<t?new _e:new Je}function xt(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof v)return i;{let a=r.head;e=r.tail,t=s,n=i+s+a}}}function mt(e,t){if(e instanceof v)return"";{let n=e.head,r=e.tail;return xt(r,t,n)}}function K(e,t){if(e instanceof p){let n=e[0];return t(n)}else return e}const ie="src/gleam_community/colour.gleam";class he extends l{constructor(t,n,r,s){super(),this.r=t,this.g=n,this.b=r,this.a=s}}class vt extends l{constructor(t,n,r,s){super(),this.h=t,this.s=n,this.l=r,this.a=s}}function N(e){return e>1||e<0?new I(void 0):new p(e)}function Y(e,t,n){let r;e<0?r=e+1:e>1?r=e-1:r=e;let s=r,i=s*6,a=s*2,u=s*3;return i<1?t+(n-t)*s*6:a<1?n:u<2?t+(n-t)*(2/3-s)*6:t}function $t(e,t,n,r){let s;n<=.5?s=n*(t+1):s=n+t-n*t;let a=s,u=n*2-a,c=Y(e+1/3,u,a),o=Y(e,u,a),f=Y(e-1/3,u,a);return[c,o,f,r]}function yt(e,t,n,r){return K(N(e),s=>K(N(t),i=>K(N(n),a=>K(N(r),u=>new p(new vt(s,i,a,u))))))}function we(e,t,n){return yt(e,t,n,1)}function bt(e){if(e instanceof he){let t=e.r,n=e.g,r=e.b,s=e.a;return[t,n,r,s]}else{let t=e.h,n=e.s,r=e.l,s=e.a;return $t(t,n,r,s)}}function ae(e){let t=bt(e),n,r,s,i;n=t[0],r=t[1],s=t[2],i=t[3];let a=c=>{let o,d=se(c,1e4),_=ne(d),g=_;o=re(g,100);let h=o,x;if(h instanceof p)x=h[0];else throw m("let_assert",ie,"gleam_community/colour",706,"to_css_rgba_string","Pattern match failed, no pattern matched the value.",{value:h,start:20510,end:20646,pattern_start:20521,pattern_end:20526});return x},u=c=>{let o,d=se(c,1e3),_=ne(d),g=_;o=re(g,1e3);let h=o,x;if(h instanceof p)x=h[0];else throw m("let_assert",ie,"gleam_community/colour",718,"to_css_rgba_string","Pattern match failed, no pattern matched the value.",{value:h,start:20768,end:20903,pattern_start:20779,pattern_end:20784});return x};return mt(E(["rgba(",O(a(n))+"%,",O(a(r))+"%,",O(a(s))+"%,",O(u(i)),")"]),"")}const Pt=new he(.5411764705882353,.8862745098039215,.20392156862745098,1);function Tt(e){return Math.sin(e)}function ge(){return Math.PI}function Et(e,t){return Math.atan2(e,t)}function kt(e){return Math.cos(e)}function At(e,t){return Et(e,t)}function St(e){return kt(e)}function xe(e){return Tt(e)}function me(e,t){let n=e*St(t),r=e*xe(t);return[n,r]}function Lt(e){return e*ge()/180}function ve(){return ge()}function R(){return 2*ve()}function Mt(){return Math.PI}class $e extends l{}class ye extends l{constructor(t,n){super(),this[0]=t,this.closed=n}}class be extends l{constructor(t,n,r){super(),this.radius=t,this.start=n,this.end=r}}class It extends l{constructor(t,n){super(),this.text=t,this.style=n}}class Ot extends l{constructor(t,n,r){super(),this[0]=t,this.width_px=n,this.height_px=r}}class Pe extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Te extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Kt extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Ee extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class ke extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Nt extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Ae extends l{constructor(t){super(),this[0]=t}}class Rt extends l{}class Se extends l{}class ue extends l{constructor(t){super(),this[0]=t}}function Le(){return new $e}function Ft(e){return new ye(e,!0)}function Me(e,t){return Ft(E([[0,0],[e,0],[e,t],[0,t]]))}function qt(e){return Me(e,e)}function Ie(e,t,n){return new Ee(e,[t,n])}function Ct(e,t){return new ke(e,[t,t])}function G(e,t){return new Pe(e,t)}function Z(e){return new Te(e,new Se)}function le(e){return new Ae(e)}function Bt(e){return new be(e,new ue(0),new ue(2*Mt()))}class Oe extends l{constructor(t){super(),this[0]=t}}class Ke extends l{constructor(t){super(),this[0]=t}}class Xt extends l{constructor(t){super(),this[0]=t}}class Ne extends l{constructor(t,n){super(),this[0]=t,this[1]=n}}class Re extends l{constructor(t){super(),this[0]=t}}class Fe extends l{constructor(t){super(),this[0]=t}}class qe extends l{}class Ce extends l{}class Be extends l{}class Xe extends l{}class Dt extends l{}class Ht extends l{}class Yt extends l{}class jt extends l{}class Ut extends l{}class zt extends l{}class Vt extends l{}class Wt extends l{}class Gt extends l{}class Zt extends l{}class Jt extends l{}class U extends l{}class Qt extends l{}class en extends l{}function tn(e){return document.querySelector(e).getContext("2d")}function De(e){window.requestAnimationFrame(t=>{e(t)})}function j(e,t){window.addEventListener(e,t)}function nn(e){return e.keyCode}function k(e,t){typeof window.PAINT_STATE>"u"&&(window.PAINT_STATE={}),window.PAINT_STATE[t]=e}function A(e){return window.PAINT_STATE?e in window.PAINT_STATE?new p(window.PAINT_STATE[e]):new I(void 0):new I(void 0)}function rn(e){return e.canvas.clientWidth}function sn(e){return e.canvas.clientHeight}function an(e,t){const n=e.canvas.getBoundingClientRect(),r=e.canvas.width/n.width,s=e.canvas.height/n.height;return[(t.clientX-n.left)*r,(t.clientY-n.top)*s]}function un(e,t,n,r){let s=Ge(t)?Ze(t).buttons:0,i=e.buttons;return r?s=~s:i=~i,!!(s&i&1<<n)}function ln(e){e.reset()}function cn(e,t,n,r,s,i){e.beginPath(),e.arc(0,0,t,n,r),s&&e.fill(),i&&e.stroke()}function on(e,t,n,r,s){e.beginPath(),e.moveTo(0,0);let i=!1;for(const a of t){let u=a[0],c=a[1];i?e.lineTo(u,c):(e.moveTo(u,c),i=!0)}n&&e.closePath(),r&&n&&e.fill(),s&&e.stroke()}function fn(e,t,n){e.font=n,e.fillText(t,0,0)}function b(e){e.save()}function P(e){e.restore()}function _n(e,t){e.fillStyle=t}function dn(e,t){e.strokeStyle=t}function pn(e,t){e.lineWidth=t}function hn(e,t,n){e.translate(t,n)}function wn(e,t,n){e.scale(t,n)}function gn(e,t){e.rotate(t)}function xn(e,t,n,r){e.drawImage(t,0,0,n,r)}function mn(e,t){e.imageSmoothingEnabled=t}const M="src/paint/canvas.gleam";class vn extends l{constructor(t,n){super(),this.width=t,this.height=n}}class F extends l{constructor(t,n){super(),this.fill=t,this.stroke=n}}function $(e,t,n){for(;;){let r=e,s=t,i=n;if(r instanceof $e)return;if(r instanceof ye){let a=r[0],u=r.closed;return on(s,a,u,i.fill,i.stroke)}else if(r instanceof be){let a=r.radius,u=r.start,c=r.end,o;o=u[0];let f;return f=c[0],cn(s,a,o,f,i.fill,i.stroke)}else if(r instanceof It){let a=r.text,u=r.style,c,o;return c=u.size_px,o=u.font_family,b(s),fn(s,a,it(c)+"px "+o),P(s)}else if(r instanceof Ot){let a=r.width_px,u=r.height_px,c=r[0].id,o=A(c),f;if(o instanceof p)f=o[0];else throw m("let_assert",M,"paint/canvas",231,"display_on_rendering_context","Pattern match failed, no pattern matched the value.",{value:o,start:6608,end:6657,pattern_start:6619,pattern_end:6628});return xn(s,f,a,u)}else if(r instanceof Pe){let a=r[0],u=r[1];return b(s),_n(s,ae(u)),$(a,s,new F(!0,i.stroke)),P(s)}else if(r instanceof Te){let a=r[0],u=r[1];if(u instanceof Se)e=a,t=s,n=new F(i.fill,!1);else{let c=u[0],o=u[1];return b(s),dn(s,ae(c)),pn(s,o),$(a,s,new F(i.fill,!0)),P(s)}}else if(r instanceof Kt){let a=r[0],u=r[1];return b(s),mn(s,u instanceof Rt),$(a,s,i),P(s)}else if(r instanceof Ee){let a=r[0],u=r[1],c,o;return c=u[0],o=u[1],b(s),hn(s,c,o),$(a,s,i),P(s)}else if(r instanceof ke){let a=r[0],u=r[1],c,o;return c=u[0],o=u[1],b(s),wn(s,c,o),$(a,s,i),P(s)}else if(r instanceof Nt){let a=r[0],u=r[1],c;return c=u[0],b(s),gn(s,c),$(a,s,i),P(s)}else{let a=r[0];if(a instanceof v)return;{let u=a.head,c=a.tail;$(u,s,i),e=new Ae(c),t=s,n=i}}}}function $n(e){return e===32?new w(new Dt):e===37?new w(new qe):e===38?new w(new Be):e===39?new w(new Ce):e===40?new w(new Xe):e===87?new w(new Ht):e===65?new w(new Yt):e===83?new w(new jt):e===68?new w(new Ut):e===90?new w(new zt):e===88?new w(new Vt):e===67?new w(new Wt):e===18?new w(new Gt):e===27?new w(new Zt):e===8?new w(new Jt):new Qe}const yn=new F(!1,!0);function He(e,t,n,r){return s=>{let i=A(r),a;if(i instanceof p)a=i[0];else throw m("let_assert",M,"paint/canvas",399,"get_tick_func","Pattern match failed, no pattern matched the value.",{value:i,start:11581,end:11644,pattern_start:11592,pattern_end:11609});let u=n(a,new Oe(s));k(u,r);let c=t(u);return ln(e),$(c,e,yn),De(He(e,t,n,r))}}function bn(e,t,n,r){let s=tn(r),i=e(new vn(rn(s),sn(s)));k(i,r);let a=(c,o)=>j(c,f=>{let d=$n(nn(f));if(d instanceof w){let _=d[0],g=A(r),h;if(g instanceof p)h=g[0];else throw m("let_assert",M,"paint/canvas",292,"interact","Pattern match failed, no pattern matched the value.",{value:g,start:8332,end:8391,pattern_start:8343,pattern_end:8356});let x=t(h,o(_));return k(x,r)}else return});a("keydown",c=>new Ke(c)),a("keyup",c=>new Xt(c)),j("mousemove",c=>{let o=an(s,c),f,d;f=o[0],d=o[1];let _=A(r),g;if(_ instanceof p)g=_[0];else throw m("let_assert",M,"paint/canvas",309,"interact","Pattern match failed, no pattern matched the value.",{value:_,start:8863,end:8922,pattern_start:8874,pattern_end:8887});let h=t(g,new Ne(f,d));k(h,r)});let u=(c,o,f)=>j(c,d=>{let _="PAINT_PREVIOUS_MOUSE_INPUT_FOR_"+r,g=A(_);k(d,_);let h=D=>un(d,g,D,f),x=D=>{let H=A(r),Q;if(H instanceof p)Q=H[0];else throw m("let_assert",M,"paint/canvas",338,"interact","Pattern match failed, no pattern matched the value.",{value:H,start:9856,end:9915,pattern_start:9867,pattern_end:9880});let Ve=t(Q,o(D));return k(Ve,r)};h(0)&&x(new U),h(1)&&x(new Qt),h(2)&&x(new en)});return u("mousedown",c=>new Re(c),!0),u("mouseup",c=>new Fe(c),!1),De(He(s,n,t,r))}class y extends l{constructor(t,n){super(),this.x=t,this.y=n}}function Pn(e){return E([e.x,e.y])}function Ye(e,t,n){return new y(n(e.x,t.x),n(e.y,t.y))}const Tn="src/vec/vec2f.gleam";function En(e,t){return Ye(e,t,ht)}function kn(e){let n=Pn(e),r=W(n,s=>s*s);return pt(r)}function An(e,t){let r=Ye(e,t,wt);return kn(r)}function Sn(e,t){let n,r=An(e,t);n=_t(r);let s=n,i;if(s instanceof p)i=s[0];else throw m("let_assert",Tn,"vec/vec2f",385,"distance","Pattern match failed, no pattern matched the value.",{value:s,start:8217,end:8288,pattern_start:8228,pattern_end:8240});return i}const je="src/app.gleam";class T extends l{constructor(t,n,r,s,i,a,u){super(),this.avatar=t,this.camera=n,this.speed=r,this.dots=s,this.mouse_pos=i,this.drag=a,this.current_time=u}}class B extends l{constructor(t,n){super(),this.pos=t,this.dir=n}}let Ln=class extends l{constructor(t,n){super(),this.pos=t,this.height=n}};class Ue extends l{constructor(t,n){super(),this.lagging_dir=t,this.start_move_time=n}}class X extends l{}class Mn extends l{constructor(t){super(),this.start_pos=t}}function In(e,t,n){let r=t*n,s=me(r,e.dir),i,a;return i=s[0],a=s[1],new B(En(e.pos,new y(i,a)),e.dir)}function On(){let e=we(.12,1,.7),t;if(e instanceof p)t=e[0];else throw m("let_assert",je,"app",216,"view_dot","Pattern match failed, no pattern matched the value.",{value:e,start:4612,end:4670,pattern_start:4623,pattern_end:4636});let n=Bt(300),r=G(n,t);return Z(r)}function ze(e,t,n){let r=100,s=e.start_move_time,i=s+r;if(n>=i)return t;{let u=S(n-s,r);return t*u+e.lagging_dir*(1-u)}}function Kn(e){return S(1,S(e,.2)+1)}function Nn(e,t){let n=me(e,t),r,s;return r=n[0],s=n[1],new y(r,s)}function Rn(e){let t=.8*R(),n,r=st(0,200);n=W(r,i=>{let a=i;return new Ln(Nn((a+1)*2+10,a/20*R()),xe(a/5*R()))});let s=n;return new T(new B(new y(0,0),t),new Ue(t,0),.01,s,new y(0,0),new X,0)}function ce(e,t,n,r){return At(r-t,n-e)}function Fn(e){for(;;){let t=e,n=R(),r=ve(),s=pe(r),i=t;if(i>r)e=i-n;else{let a=t;if(a<=s)e=a+n;else return t}}}const qn=300,Cn=300;function Bn(){let e=we(.85,.5,.96),t;if(e instanceof p)t=e[0];else throw m("let_assert",je,"app",208,"view_background","Pattern match failed, no pattern matched the value.",{value:e,start:4448,end:4506,pattern_start:4459,pattern_end:4471});let n=Me(qn,Cn),r=G(n,t);return Z(r)}const q=new y(150,150);function Xn(e,t,n){let r=Lt(45),s=ce(t.pos.x,t.pos.y,e.pos.x,e.pos.y),i=Fn(s-t.dir);if(te(i)>r)return Le();{let u=te(Sn(t.pos,e.pos)),c=ce(0,0,u,e.height),o=Kn(u),f=new y(S(i*q.x,r),S(c*q.x,r)),_=Ct(n,o);return Ie(_,f.x,f.y)}}function Dn(e){let t,n=e.avatar;t=new B(n.pos,ze(e.camera,e.avatar.dir,e.current_time));let r=t,s=On(),i,a=le((()=>{let d=e.dots;return W(d,_=>Xn(_,r,s))})());i=Ie(a,q.x,q.y);let u=i,c;if(e.drag instanceof X)c=Le();else{let d=qt(30),_=G(d,Pt);c=Z(_)}let f=c;return le(E([Bn(),u,f]))}const Hn=.005,Yn=.4;function oe(e,t){return new T(e.avatar,e.camera,ot(e.speed+t*(e.speed*.05),Hn,Yn),e.dots,e.mouse_pos,e.drag,e.current_time)}const jn=.09;function Un(e,t){return new B(e.pos,e.dir+jn*t)}function z(e,t){return new T(Un(e.avatar,t),new Ue(ze(e.camera,e.avatar.dir,e.current_time),e.current_time),e.speed,e.dots,e.mouse_pos,e.drag,e.current_time)}function zn(e,t){let n=e.drag;if(n instanceof X)return e;{let r=n.start_pos,s=(e.mouse_pos.x-r.x)*.01;return z(e,s)}}function Vn(e,t){if(t instanceof Oe){let n=t[0],r=n-e.current_time,s=new T(In(e.avatar,e.speed,r),e.camera,e.speed,e.dots,e.mouse_pos,e.drag,n);return zn(s)}else if(t instanceof Ke){let n=t[0];return n instanceof qe?z(e,-1):n instanceof Ce?z(e,1):n instanceof Be?oe(e,1):n instanceof Xe?oe(e,-1):e}else if(t instanceof Ne){let n=t[0],r=t[1];return new T(e.avatar,e.camera,e.speed,e.dots,new y(n,r),e.drag,e.current_time)}else return t instanceof Re?t[0]instanceof U?new T(e.avatar,e.camera,e.speed,e.dots,e.mouse_pos,new Mn(e.mouse_pos),e.current_time):e:t instanceof Fe&&t[0]instanceof U?new T(e.avatar,e.camera,e.speed,e.dots,e.mouse_pos,new X,e.current_time):e}function Wn(){return bn(Rn,Vn,Dn,"#app")}Wn();document.addEventListener("touchmove",e=>{e.preventDefault()},{passive:!1});const J=(e,t)=>n=>{const r=n.touches?.item(0),s=r?{screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY}:{};e==="mousedown"&&window.dispatchEvent(new MouseEvent("mousemove",{...s})),window.dispatchEvent(new MouseEvent(e,{buttons:t,...s}))};window.addEventListener("touchstart",J("mousedown",1));window.addEventListener("touchend",J("mouseup",0));window.addEventListener("touchmove",J("mousemove",void 0));
